<!DOCTYPE html><html><head>
      <title>README</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\Magenta\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.6.7\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p,html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div{display:inline}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  300px/2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header" id="-three-molecules-">Three-Molecules</h1>

<p>A demonstration of how to draw molecular diagrams with Three.js</p>
<h2 class="mume-header" id="-getting-started-">Getting Started</h2>

<p>This is a demonstration of how to draw molecular diagrams with Three.js. It is based on the <a href="https://threejs.org/">Three.js</a> library, which is a JavaScript library for drawing 3D graphics in a web browser. This code takes a <code>.mol</code> file and converts it to a JSON object, which is then used to draw the 3D model of the molecule.</p>
<h3 class="mume-header" id="-accessing-the-individual-steps-">Accessing the Individual Steps</h3>

<p>Each major step involved in building this application is in a separate branch of this repository. To access the files at each step, you need to clone this repository to your computer, and then check out the branch for the exercise you want to work on.</p>
<p>By default you will probably start in the main branch. This branch will have the final completed version of the project. To see the result of each steps, you can check out the branch for that step.</p>
<p>To list all of the branches in this repository, use this command:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token function">git</span> branch -a
</pre><p>Each of the steps will be named <code>step-1</code>, <code>step-2</code>, etc. To check out a branch, use this command:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token function">git</span> checkout step-1
</pre><p>You will then be able to see the code for that step. You can then make changes to the code, and see the result in your web browser once you have a web server running and you have refreshed the page.</p>
<h3 class="mume-header" id="-running-a-web-server-">Running a Web Server</h3>

<p>Because we may need to load external files, such as images and 3D models, we have to deal with Cross-Origin Resource Sharing (CORS) requests. You can allow access to local files in a particular directory in your browser, but its preferable to run a web server to serve the files.</p>
<p>If you have Node.js installed, you can use the <a href="https://www.npmjs.com/package/http-server"><code>http-server</code></a> package to quickly run a web server from the project director, using the command:</p>
<pre data-role="codeBlock" data-info class="language-"><code>http-server -a localhost -p 8000
</code></pre><p>You can then visit <a href="http://localhost:8000">http://localhost:8000</a> in your browser and will see the contents of the <code>index.html</code> file in the root of the directory being served.</p>
<p>If you don&apos;t have Node.js installed, you can use the <code>python -m SimpleHTTPServer</code> command to run a web server instead.</p>
<p>You can also use something like a <a href="https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer">Live Server</a> extension for Visual Studio Code.</p>
<h2 class="mume-header" id="-step-1-import-threejs-">Step 1: Import Three.js</h2>

<p>Start by setting up a basic file structure and importing version <code>r150</code> of the Three.js library. Note: you can also install the ES6 module version of Three.js using <code>npm install three</code> and this method is recommended for more complex projects. But for this simple example, we will use the minified version of the older version of the library.</p>
<p>First, make a file called <code>index.html</code> and add the following code:</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Three JS Molecules<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</pre><p>Then, you need to download the Three.js library. You can download the minified version from the <a href="https://raw.githubusercontent.com/mrdoob/three.js/dev/build/three.min.js">Three.js Github Repository</a> and save it in a folder called <code>js</code> in the root of your project directory,<br>
so we have something like this to get started from:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token builtin class-name">.</span>
&#x251C;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; js
&#x2502;   &#x2514;&#x2500;&#x2500; three.min.js
&#x2514;&#x2500;&#x2500; README.md
</pre><p>Now, we can add the Three.js library to our <code>index.html</code> file. We will add it to the <code>&lt;head&gt;</code> section of the file, and we will add it as a <code>&lt;script&gt;</code> tag.</p>
<pre data-role="codeBlock" data-info="diff" class="language-diff"><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">!DOCTYPE html&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">html&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">head&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;title&gt;Three JS Molecules&lt;/title&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   &lt;script src=&quot;js/three.min.js&quot;&gt;&lt;/script&gt; 
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/head&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">body&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/body&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">/html&gt;
</span></span></pre><p>and then add a <code>&lt;script&gt;</code> tag to the end of the <code>&lt;body&gt;</code> section of the file.</p>
<pre data-role="codeBlock" data-info="diff" class="language-diff"><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">!DOCTYPE html&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">html&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">head&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;title&gt;Three JS Molecules&lt;/title&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;script src=&quot;js/three.min.js&quot;&gt;&lt;/script&gt; 
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/head&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">body&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   &lt;script&gt;
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">   &lt;/script&gt;   
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/body&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">/html&gt;
</span></span></pre><p>Inside that script tag, we can start to write our JavaScript code that will define what our 3D scene looks like.</p>
<p>Using the code from the <a href="https://threejs.org/docs/#manual/en/introduction/Creating-a-scene">creating a scene</a> page of the official Three.js docs, we can start by with creating a scene, a camera, and a renderer. We can then add the camera to the scene, and add the renderer to the <code>&lt;body&gt;</code> section of the page:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> scene <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-const">const</span> camera <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span> <span class="token operator">/</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token keyword keyword-const">const</span> renderer <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span><span class="token method function property-access">setSize</span><span class="token punctuation">(</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span><span class="token punctuation">,</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span> renderer<span class="token punctuation">.</span><span class="token property-access">domElement</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Next, to add a basic cube to the scene, we can use the code from the documentation and add it to the scene, and adjust the camera&apos;s <code>position.x</code>, <code>position.y</code> and <code>position.z</code> values so that we can see the multiple faces of the cube, then we can use the <code>lookAt()</code> method to make the camera look at the center of the scene (coordinates <code>0,0,0</code>):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> geometry <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-const">const</span> material <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0x00ff00</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-const">const</span> cube <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span> geometry<span class="token punctuation">,</span> material <span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span> cube <span class="token punctuation">)</span><span class="token punctuation">;</span>

camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span><span class="token method function property-access">lookAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Finally, we can add a <code>render()</code> function that will be called every time the screen needs to be updated, and call it once to render the scene:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span> animate <span class="token punctuation">)</span><span class="token punctuation">;</span>
	renderer<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span> scene<span class="token punctuation">,</span> camera <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>You will also want to set a margin of 0 on the <code>&lt;body&gt;</code> tag to prevent the margins from creating overflow in the window:</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</pre><p>Put everything together, and your code will look like this:</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Three JS Molecules<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>js/three.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">body</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword keyword-const">const</span> scene <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-const">const</span> camera <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span> <span class="token operator">/</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword keyword-const">const</span> renderer <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        renderer<span class="token punctuation">.</span><span class="token method function property-access">setSize</span><span class="token punctuation">(</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span><span class="token punctuation">,</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span> renderer<span class="token punctuation">.</span><span class="token property-access">domElement</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword keyword-const">const</span> geometry <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-const">const</span> material <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0x00ff00</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-const">const</span> cube <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span> geometry<span class="token punctuation">,</span> material <span class="token punctuation">)</span><span class="token punctuation">;</span>
        scene<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span> cube <span class="token punctuation">)</span><span class="token punctuation">;</span>

        camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        camera<span class="token punctuation">.</span><span class="token method function property-access">lookAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword keyword-function">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span> animate <span class="token punctuation">)</span><span class="token punctuation">;</span>
            renderer<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span> scene<span class="token punctuation">,</span> camera <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</pre><p>You should see a green cube in the center of the browser window.</p>
<h2 class="mume-header" id="-step-2-create-an-init-function-">Step 2: Create an init() function</h2>

<p>Now that we have a basic scene set up, we can start to add some more complex objects to the scene. We will start by creating a function called <code>init()</code> that will be called when the page loads, and will contain all of the code that we need to set up the scene.</p>
<p>We need to declare the <code>scene</code>, <code>camera</code>, and <code>renderer</code> variables globally, then define items like geometries within the <code>init()</code> function:</p>
<p>and then we can define the <code>init()</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> scene <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-const">const</span> camera <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span> <span class="token operator">/</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> renderer <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span><span class="token method function property-access">setSize</span><span class="token punctuation">(</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span><span class="token punctuation">,</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span> renderer<span class="token punctuation">.</span><span class="token property-access">domElement</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-function">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> geometry <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-const">const</span> material <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0x00ff00</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-const">const</span> cube <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span> geometry<span class="token punctuation">,</span> material <span class="token punctuation">)</span><span class="token punctuation">;</span>
    scene<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span> cube <span class="token punctuation">)</span><span class="token punctuation">;</span>

    camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    camera<span class="token punctuation">.</span><span class="token method function property-access">lookAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-function">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span> animate <span class="token punctuation">)</span><span class="token punctuation">;</span>
    renderer<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span> scene<span class="token punctuation">,</span> camera <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>When we call the <code>init()</code> function before the <code>animate()</code> function, the geometry is added to the scene and the camera positioned before the animation loop starts.</p>
<p>With the code above working, you will see a green cube in the center of the browser window that looks something like this:<br>
<img src="screenshots\step-2.png" alt="green cube"></p>
<h2 class="mume-header" id="-step-3-load-a-mol-file-">Step 3: Load a mol file</h2>

<p>Now that we have a basic scene set up, we can start to add some more complex objects to the scene. We will start by creating a function that fetches a mol file from the server, and then parses it to create a Three.js mesh.</p>
<p>First, create folder where you will store your mol files, in my case I will create a folder called <code>molecules</code> in the root of the project and add some mol files retrieved from ChemSpider and named using their respective ChemSpider IDs:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token builtin class-name">.</span>
&#x251C;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; js
&#x2502;   &#x2514;&#x2500;&#x2500; three.min.js
&#x251C;&#x2500;&#x2500; molecules
&#x2502;   &#x2514;&#x2500;&#x2500; <span class="token number">2424</span>.mol
&#x2514;&#x2500;&#x2500; README.md
</pre><p>I&apos;ve added 2424.mol to the molecules folder, the Chemspider ID for caffeine.</p>
<p>Let&apos;s fetch the mol file from the server and parse it to create a Three.js mesh. We will start by fetching the mol file from the server using the <code>fetch()</code> function.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&apos;molecules/2424.mol&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token arrow operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token method function property-access">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>We can refactor the <code>init()</code> function to use a parameter which defines the ID of the molfile to load:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> scene <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-const">const</span> camera <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span> <span class="token operator">/</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-const">const</span> renderer <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span><span class="token method function property-access">setSize</span><span class="token punctuation">(</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span><span class="token punctuation">,</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span> renderer<span class="token punctuation">.</span><span class="token property-access">domElement</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-function">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">CSID</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&apos;molecules/&apos;</span> <span class="token operator">+</span> <span class="token constant">CSID</span> <span class="token operator">+</span> <span class="token string">&apos;.mol&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token arrow operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token method function property-access">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-function">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span> animate <span class="token punctuation">)</span><span class="token punctuation">;</span>
    renderer<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span> scene<span class="token punctuation">,</span> camera <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-const">const</span> defaultCSID <span class="token operator">=</span> <span class="token number">2424</span><span class="token punctuation">;</span>

<span class="token function">init</span><span class="token punctuation">(</span>defaultCSID<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>This will log the mol file to the console. In order to understand the mol file format, articles <a href="https://chem.libretexts.org/Courses/University_of_Arkansas_Little_Rock/ChemInformatics_(2017)%3A_Chem_4399_5399/2.2%3A_Chemical_Representations_on_Computer%3A_Part_II/2.2.2%3A_Anatomy_of_a_MOL_file">like this</a> are very useful as well as the <a href="https://en.wikipedia.org/wiki/Chemical_table_file#:~:text=An%20MDL%20Molfile%20is%20a,sections%20for%20more%20complex%20information.">Wikipedia article on chemical table file formats</a>.</p>
<h2 class="mume-header" id="-step-4-parsing-a-mol-file-">Step 4: Parsing a mol file</h2>

<p>Let&apos;s break down the basic contents of the 2424.mol file:</p>
<p>The first three lines of a mol file contain information about the file itself, including a name (first line), information about the program that created the file (second line), and a third line that may contain a comment (and is sometimes used to store dates). The contents of these lines vary depending on the program used for their creation and there is a degree of inconsistency in the way that they are used.</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token number">2519</span>
  Marvin  12300703363D          

</pre><p>Next, the fourth line contains information about the number of atoms and bonds in the molecule:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"> <span class="token number">24</span> <span class="token number">25</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>            <span class="token number">999</span> V2000
</pre><p>Here it becomes important to note that mol files are arranged in a fixed-width format, with each line containing a fixed number of characters. The first three characters of each line contain the number of atoms in the molecule, the next three characters contain the number of bonds, and the next six characters contain the number of charges, the number of isotopes, the number of stereo centers, the number of stereo bonds, and the number of unknown properties, respectively. The next six characters are reserved for future use, and the last three characters are used to indicate the version of the mol file format (in the case of the caffeine mol file retrieved from Chemspider, this is V2000).</p>
<p>The first two numbers are what we are particularly interested in, as they are going to help with parsing the rest of the file, as each atom receives its own line after the fourth line, and the bonds are listed after the atoms.</p>
<p>We can start by creating a function that parses the content of the mol file that will return a JSON object containing the information we want about the atoms and bonds in the molecule:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">molFileToJSON</span><span class="token punctuation">(</span><span class="token parameter">molFile</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword keyword-let">let</span> molObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow keyword-return">return</span> molObj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>We can then split the string in to an array of lines:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">molFileToJSON</span><span class="token punctuation">(</span><span class="token parameter">molFile</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword keyword-let">let</span> molObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-const">const</span> split <span class="token operator">=</span> molFile<span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">&apos;\n&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword control-flow keyword-return">return</span> molObj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>We can then get the counts by chunking the line of the array:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">molFileToJSON</span><span class="token punctuation">(</span><span class="token parameter">molFile</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword keyword-let">let</span> molObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-const">const</span> split <span class="token operator">=</span> molFile<span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">&apos;\n&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-const">const</span> countChunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-let">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> split<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        countChunks<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword control-flow keyword-return">return</span> molObj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>Since mol files don&apos;t use padding on their number we then need to trim their the whitespace from the chunks before assigning them in the molObj:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-function">function</span> <span class="token function">molFileToJSON</span><span class="token punctuation">(</span><span class="token parameter">molFile</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword keyword-let">let</span> molObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-const">const</span> split <span class="token operator">=</span> molFile<span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">&apos;\n&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-const">const</span> countChunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-let">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> split<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        countChunks<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">molecules</span> <span class="token operator">=</span> countChunks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">bonds</span> <span class="token operator">=</span> countChunks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">lists</span> <span class="token operator">=</span> countChunks<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">chiral</span> <span class="token operator">=</span> countChunks<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">stext</span> <span class="token operator">=</span> countChunks<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword control-flow keyword-return">return</span> molObj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>Once we have count for <code>molObj.counts.molecules</code> and <code>molObj.counts.bonds</code> we can then use them to parse the atoms and bonds in the file. In 2425.mol, since there are 24 atoms and 25 bonds, the atoms are listed from line 5 to line 28, and the bonds are listed from line 29 to line 53. A line describing a single atom looks like this:</p>
<pre data-role="codeBlock" data-info="text" class="language-text">    0.2334   -2.4028    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
</pre><p>The X, Y, and Z columns contain the coordinates of the atom, the next column contains the element symbol. The X, Y, and Z coordinates are in the format #####.####, five digits for the integer part and four digits for the decimal part, so columns 1-10 contain the X coordinate, columns 11-20 contain the Y coordinate, and columns 21-30 contain the Z coordinate. The next column contains the Molecule&apos;s symbol (i.e. O for Oxygen, Na for Sodium, etc.).</p>
<p>We can parse each of the atoms by iterating over the lines starting from the fifth line and finishing at line 5 + <code>molObj.counts.molecules</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> atomsArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword control-flow keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-let">let</span> i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">molecules</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> atom <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    atom<span class="token punctuation">.</span><span class="token property-access">position</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    atom<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">=</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    atom<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">=</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    atom<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span> <span class="token operator">=</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    atom<span class="token punctuation">.</span><span class="token property-access">type</span> <span class="token operator">=</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    atomsArray<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>atom<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
molObj<span class="token punctuation">.</span><span class="token property-access">atoms</span> <span class="token operator">=</span> atomsArray<span class="token punctuation">;</span>
</pre><p>I like to use the format <code>position: {x,y,z}</code> to store the positions, as it matches the syntax used in the Three.js library. Thus you can access the X coordinate of the first atom in the molecule by using <code>molObj.atoms[0].position.x</code> and it&apos;s type (element symbol, i.e. O for Oxygen, Na for Sodium) by using <code>molObj.atoms[0].type</code>.</p>
<p>Next, we want to retrieve the bonds. A line describing a single bond looks like this:</p>
<pre data-role="codeBlock" data-info="text" class="language-text">  1  9  2  0  0  0  0
</pre><p>This is a connection table. The first two columns contain the index of the atoms that are connected by the bond (the order in which they appeared in the file). The third column contains the bond type. Thus it is crucial to keep the order of the atoms in the molObj&apos;s atom array in the same order as the order in which they appear in the file. One should note that <strong><code>.mol</code> files have a starting index of 1</strong>.</p>
<p>We can retrieve the bonds by iterating over the lines starting from the 5 + <code>molObj.counts.molecules</code> line and finishing at line 5 + <code>molObj.counts.molecules</code> + <code>molObj.counts.bonds</code>, and write them in a 2D array as <code>molObj.bonds</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> bondsArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword control-flow keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-let">let</span> i <span class="token operator">=</span> <span class="token number">4</span><span class="token operator">+</span><span class="token function">parseInt</span><span class="token punctuation">(</span>molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">molecules</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">+</span><span class="token function">parseInt</span><span class="token punctuation">(</span>molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">molecules</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">bonds</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> bond <span class="token operator">=</span> <span class="token punctuation">[</span>split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    bondsArray<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>bond<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
molObj<span class="token punctuation">.</span><span class="token property-access">bonds</span> <span class="token operator">=</span> bondsArray<span class="token punctuation">;</span>
</pre><p>With the addition of objects to represent the header of the <code>.mol</code> file, the code looks like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> <span class="token function-variable function">molFileToJSON</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">molFile</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-let">let</span> molObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-const">const</span> split <span class="token operator">=</span> molFile<span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">&apos;\n&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    molObj<span class="token punctuation">.</span><span class="token property-access">header</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">header</span><span class="token punctuation">.</span><span class="token property-access">title</span> <span class="token operator">=</span> split<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">header</span><span class="token punctuation">.</span><span class="token property-access">program</span> <span class="token operator">=</span> split<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">&apos;  &apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">header</span><span class="token punctuation">.</span><span class="token property-access">timeStamp</span> <span class="token operator">=</span> split<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">&apos;  &apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">header</span><span class="token punctuation">.</span><span class="token property-access">comment</span> <span class="token operator">=</span> split<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token keyword keyword-const">const</span> countChunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-let">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> split<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        countChunks<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">molecules</span> <span class="token operator">=</span> countChunks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">bonds</span> <span class="token operator">=</span> countChunks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">lists</span> <span class="token operator">=</span> countChunks<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">chiral</span> <span class="token operator">=</span> countChunks<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">stext</span> <span class="token operator">=</span> countChunks<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-const">const</span> atomsArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-let">let</span> i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">molecules</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-const">const</span> atom <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        atom<span class="token punctuation">.</span><span class="token property-access">position</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        atom<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">=</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        atom<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">=</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        atom<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span> <span class="token operator">=</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        atom<span class="token punctuation">.</span><span class="token property-access">type</span> <span class="token operator">=</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        atomsArray<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>atom<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">atoms</span> <span class="token operator">=</span> atomsArray<span class="token punctuation">;</span>

    <span class="token keyword keyword-const">const</span> bondsArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-let">let</span> i <span class="token operator">=</span> <span class="token number">4</span><span class="token operator">+</span><span class="token function">parseInt</span><span class="token punctuation">(</span>molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">molecules</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">+</span><span class="token function">parseInt</span><span class="token punctuation">(</span>molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">molecules</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>molObj<span class="token punctuation">.</span><span class="token property-access">counts</span><span class="token punctuation">.</span><span class="token property-access">bonds</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-const">const</span> bond <span class="token operator">=</span> <span class="token punctuation">[</span>split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> split<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        bondsArray<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>bond<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    molObj<span class="token punctuation">.</span><span class="token property-access">bonds</span> <span class="token operator">=</span> bondsArray<span class="token punctuation">;</span>

    <span class="token keyword control-flow keyword-return">return</span> molObj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><h2 class="mume-header" id="-step-5-import-the-conversion-function-into-the-project-">Step 5: import the conversion function into the project:</h2>

<p>We can make a new file and call it <code>molFileToJSON.js</code>. We can then import the function into the project by adding the following line to the top of <code>index.js</code>:</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Three JS Molecules<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>js/three.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>js/molFileToJSON.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">body</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
</pre><p>We can then call the function in the <code>drawMolecule</code> function:</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword keyword-const">const</span> scene <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-const">const</span> camera <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span> <span class="token operator">/</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword keyword-const">const</span> renderer <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        renderer<span class="token punctuation">.</span><span class="token method function property-access">setSize</span><span class="token punctuation">(</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span><span class="token punctuation">,</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerHeight</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span> renderer<span class="token punctuation">.</span><span class="token property-access">domElement</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword keyword-const">const</span> geometry <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-const">const</span> material <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0xffff00</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword keyword-function">function</span> <span class="token function">drawMolecule</span><span class="token punctuation">(</span><span class="token parameter">molFile</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword keyword-const">const</span> molObject <span class="token operator">=</span> <span class="token function">molFileToJSON</span><span class="token punctuation">(</span>molFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token keyword control-flow keyword-for">for</span><span class="token punctuation">(</span><span class="token keyword keyword-let">let</span> item <span class="token keyword keyword-of">of</span> molObject<span class="token punctuation">.</span><span class="token property-access">atoms</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword keyword-const">const</span> sphere <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span> geometry<span class="token punctuation">,</span> material <span class="token punctuation">)</span><span class="token punctuation">;</span>
                sphere<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">;</span>
                sphere<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">;</span>
                sphere<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span> <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">;</span>
                scene<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span> sphere <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword keyword-function">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">CSID</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&apos;molecules/&apos;</span> <span class="token operator">+</span> <span class="token constant">CSID</span> <span class="token operator">+</span> <span class="token string">&apos;.mol&apos;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token arrow operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token method function property-access">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">molFile</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token function">drawMolecule</span><span class="token punctuation">(</span>molFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
            camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
            camera<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
            camera<span class="token punctuation">.</span><span class="token method function property-access">lookAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword keyword-function">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span> animate <span class="token punctuation">)</span><span class="token punctuation">;</span>
            renderer<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span> scene<span class="token punctuation">,</span> camera <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword keyword-const">const</span> defaultCSID <span class="token operator">=</span> <span class="token number">2424</span><span class="token punctuation">;</span>
        
        <span class="token function">init</span><span class="token punctuation">(</span>defaultCSID<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</pre><p>You will now see a sphere for each atom in the molecule, positioned according to the coordinates specified in the <code>.mol</code> file. The spheres are all the same size and color, and due to a lack of shading, appear to be flat.</p>
<p>What you should see so far will look like this:<br>
<img src="screenshots\step-5.png" alt="Step-5"></p>
<h2 class="mume-header" id="-step-6-clear-the-scene-when-the-init-function-is-called-">Step 6: Clear the scene when the init function is called:</h2>

<p>We can clear the scene when the <code>init</code> function is called by adding the following lines to the start of the <code>init</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword control-flow keyword-while">while</span><span class="token punctuation">(</span>scene<span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
    scene<span class="token punctuation">.</span><span class="token method function property-access">remove</span><span class="token punctuation">(</span>scene<span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</pre><p>This removes the spheres from the scene, so that when the <code>init</code> function is called again, the spheres are not drawn again. By changing the <code>CSID</code> variable to a different value, a different molecule can be drawn (so long as the  corresponding file is present in the <code>molecules</code> folder).</p>
<h2 class="mume-header" id="-step-7-style-the-spheres-">Step 7: Style the spheres:</h2>

<p>The various elements of the molecule can be styled by changing the values of the <code>geometry</code> and <code>material</code> variables. The <code>geometry</code> variable is used to define the shape of the sphere, and the <code>material</code> variable is used to define the color and shading of the sphere. The <code>geometry</code> variable is defined as follows:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> sphere <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span> geometry<span class="token punctuation">,</span> material <span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>If we want to vary the size of the sphere, we can use an object to hold these values in a map, and then use the <code>atom.type</code> value to select the appropriate item.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> moleculeGeometries <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;C&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.8</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;H&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.3</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;O&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.5</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;N&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;S&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.8</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;P&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;F&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Cl&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.5</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Br&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;I&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span> <span class="token number">.7</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-const">const</span> moleculeMaterials <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;C&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0x333333</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;H&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0xffffff</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;O&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0xff0000</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;N&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0x0000ff</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;S&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0xffff00</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;P&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0xff00ff</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;F&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0x00ff00</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Cl&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0x00ff00</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Br&quot;</span><span class="token operator">:</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token number">0x00ff00</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</pre><p>And we then access these items in the <code>drawMolecule</code> function when we define the sphere:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword control-flow keyword-for">for</span><span class="token punctuation">(</span><span class="token keyword keyword-let">let</span> item <span class="token keyword keyword-of">of</span> molObject<span class="token punctuation">.</span><span class="token property-access">atoms</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> sphere <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span> moleculeGeometries<span class="token punctuation">[</span>item<span class="token punctuation">.</span><span class="token property-access">type</span><span class="token punctuation">]</span><span class="token punctuation">,</span> moleculeMaterials<span class="token punctuation">[</span>item<span class="token punctuation">.</span><span class="token property-access">type</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token spread operator">...</span>
<span class="token punctuation">}</span>
</pre><h2 class="mume-header" id="-step-8-add-lighting-">Step 8: Add lighting:</h2>

<p>See: <a href="https://threejs.org/docs/#api/en/lights/SpotLight">https://threejs.org/docs/#api/en/lights/SpotLight</a></p>
<p>We can add ambient and spotlighting in our scene by including the following lines in the <code>init</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> spotLight <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SpotLight</span><span class="token punctuation">(</span> <span class="token number">0xffffff</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span><span class="token property-access">map</span> <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">load</span><span class="token punctuation">(</span> url <span class="token punctuation">)</span><span class="token punctuation">;</span>

spotLight<span class="token punctuation">.</span><span class="token property-access">castShadow</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

spotLight<span class="token punctuation">.</span><span class="token property-access">shadow</span><span class="token punctuation">.</span><span class="token property-access">mapSize</span><span class="token punctuation">.</span><span class="token property-access">width</span> <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span><span class="token property-access">shadow</span><span class="token punctuation">.</span><span class="token property-access">mapSize</span><span class="token punctuation">.</span><span class="token property-access">height</span> <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span>

spotLight<span class="token punctuation">.</span><span class="token property-access">shadow</span><span class="token punctuation">.</span><span class="token property-access">camera</span><span class="token punctuation">.</span><span class="token property-access">near</span> <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span><span class="token property-access">shadow</span><span class="token punctuation">.</span><span class="token property-access">camera</span><span class="token punctuation">.</span><span class="token property-access">far</span> <span class="token operator">=</span> <span class="token number">4000</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span><span class="token property-access">shadow</span><span class="token punctuation">.</span><span class="token property-access">camera</span><span class="token punctuation">.</span><span class="token property-access">fov</span> <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>

scene<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span> spotLight <span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The result will be something like this:<br>
<img src="screenshots\step-8.png" alt="Step-8"></p>
<h2 class="mume-header" id="-step-9-add-an-axis-helper-">Step 9: Add an axis helper:</h2>

<p>An axis helper is a useful tool built in to Three.js for visualizing orientation. We can add an axis helper to the scene by including the following line in the <code>init</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> axesHelper <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AxesHelper</span><span class="token punctuation">(</span> <span class="token number">5</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span> axesHelper <span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>With the axis helper in place, you should see something like this:<br>
<img src="screenshots\step-9.png" alt="Step-9"></p>
<p>This particular mol file of caffeine has been centered to the origin, which is useful if we consider that we will want to be able to rotate the molecule later on in the tutorial.</p>
<p>In contrast, see what happens when we load a different molecule where the origin is not at the center of the molecule (in this case, Sodium Stearate):<br>
<img src="screenshots\step-9-2.png" alt="Step-9-2"></p>
<p>Therefore, we may want to center the molecule to the origin when we load it.</p>
<h2 class="mume-header" id="-step-10-center-the-molecule-to-the-origin-">Step 10: Center the molecule to the origin:</h2>

<p>In order to center the molecule to the origin, we need to calculate the center of the molecule. To do this, we need to determine the minimum and maximum values for the x, y, and z coordinates. We can do this by iterating through the atoms in the molecule, and comparing the current value of the x, y, and z coordinates to the current minimum and maximum values. We can then use the midpoint of these values to center the molecule to the origin.</p>
<p>First, we need to create a variable to hold the minimum and maximum values for the x, y, and z coordinates, and set these to an initial value using the first item in the atoms array.</p>
<p>Doing this</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">//Get the first point in the molecule:  </span>
<span class="token keyword keyword-let">let</span> firstPoint <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>
    molObject<span class="token punctuation">.</span><span class="token property-access">atoms</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">,</span> 
    molObject<span class="token punctuation">.</span><span class="token property-access">atoms</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">,</span> 
    molObject<span class="token punctuation">.</span><span class="token property-access">atoms</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Set the initial limits to the first point:</span>
<span class="token keyword keyword-let">let</span> limits <span class="token operator">=</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token punctuation">{</span>
        min<span class="token operator">:</span> firstPoint<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">,</span>
        max<span class="token operator">:</span> firstPoint<span class="token punctuation">.</span><span class="token property-access">x</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    y<span class="token operator">:</span> <span class="token punctuation">{</span>
        min<span class="token operator">:</span> firstPoint<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">,</span>
        max<span class="token operator">:</span> firstPoint<span class="token punctuation">.</span><span class="token property-access">y</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    z<span class="token operator">:</span> <span class="token punctuation">{</span>
        min<span class="token operator">:</span> firstPoint<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">,</span>
        max<span class="token operator">:</span> firstPoint<span class="token punctuation">.</span><span class="token property-access">z</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>Then, we need to iterate through the atoms in the molecule, and compare the current value of the x, y, and z coordinates to the current minimum and maximum values:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword control-flow keyword-for">for</span><span class="token punctuation">(</span><span class="token keyword keyword-let">let</span> item <span class="token keyword keyword-of">of</span> molObject<span class="token punctuation">.</span><span class="token property-access">atoms</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword keyword-let">let</span> point <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>
        item<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">,</span> 
        item<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">,</span> 
        item<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword control-flow keyword-if">if</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">.</span><span class="token property-access">min</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        limits<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">.</span><span class="token property-access">min</span> <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow keyword-if">if</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">.</span><span class="token property-access">max</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        limits<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">.</span><span class="token property-access">max</span> <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow keyword-if">if</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">.</span><span class="token property-access">min</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        limits<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">.</span><span class="token property-access">min</span> <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow keyword-if">if</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">.</span><span class="token property-access">max</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        limits<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">.</span><span class="token property-access">max</span> <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow keyword-if">if</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">.</span><span class="token property-access">min</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        limits<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">.</span><span class="token property-access">min</span> <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow keyword-if">if</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">.</span><span class="token property-access">max</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        limits<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">.</span><span class="token property-access">max</span> <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>Then, we can create a new variable to hold the midpoint of the x, y, and z coordinates:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-let">let</span> moleculeCenter <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">.</span><span class="token property-access">min</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">.</span><span class="token property-access">max</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">.</span><span class="token property-access">min</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">.</span><span class="token property-access">max</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">.</span><span class="token property-access">min</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>limits<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">.</span><span class="token property-access">max</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Then, this can be used to center the molecule to the origin:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">sphere<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> moleculeCenter<span class="token punctuation">.</span><span class="token property-access">x</span><span class="token punctuation">;</span>
sphere<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> moleculeCenter<span class="token punctuation">.</span><span class="token property-access">y</span><span class="token punctuation">;</span>
sphere<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span> <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">.</span><span class="token property-access">z</span> <span class="token operator">-</span> moleculeCenter<span class="token punctuation">.</span><span class="token property-access">z</span><span class="token punctuation">;</span>
</pre><p>If we go back and load the Sodium Stearate molecule, we should see something like this:</p>
<p><img src="screenshots\step-10.png" alt="Step-10"></p>
<h2 class="mume-header" id="-step-11-convert-to-using-es6-modules-">Step 11: Convert to using ES6 modules:</h2>

<p>First, download <code>three.modules.js</code> file from the Three.js repository or install Three.js using npm:<br>
<a href="https://threejs.org/docs/#manual/en/introduction/Installation">https://threejs.org/docs/#manual/en/introduction/Installation</a></p>
<p>Next, remove the script tag for <code>three.js</code> from the <code>index.html</code> file:</p>
<pre data-role="codeBlock" data-info="diff" class="language-diff"><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">head&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;title&gt;Three JS Molecules&lt;/title&gt;
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   &lt;script src=&quot;js/three.min.js&quot;&gt;&lt;/script&gt; --&gt;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;script src=&quot;js/molFileToJSON.js&quot;&gt;&lt;/script&gt;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;style&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       body { margin: 0; }
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/style&gt; 
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/head&gt;
</span></span></pre><p>And we then add <code>type=&quot;module&quot;</code> to the script tag for <code>molFileToJSON.js</code>:</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</pre><p>Then, import the THREE module:</p>
<pre data-role="codeBlock" data-info="diff" class="language-diff"><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script type= &quot;module&quot; &gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   import * as THREE from &apos;./js/three.module.js&apos;;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></pre><p>This will allow us to use the ES6 module syntax in our <code>molFileToJSON.js</code> file.</p>
<h2 class="mume-header" id="-step-12-import-orbitcontrols-">Step 12: Import OrbitControls:</h2>

<p>OrbitControls is an addition to Three.js that allows us to rotate the camera around the scene. We can import OrbitControls by adding the following line to the <code>molFileToJSON.js</code> file. First, start by saving the <code>OrbitControls.js</code> file to the <code>./js/</code> folder, the continue by adding an import map to the head of the HTMl file:</p>
<pre data-role="codeBlock" data-info class="language-"><code>&lt;script type=&quot;importmap&quot;&gt;
    {
        &quot;imports&quot;: {
            &quot;three&quot;: &quot;./js/three.module.js&quot;,
            &quot;OrbitControls&quot;: &quot;./js/OrbitControls.js&quot;
        }
    }
&lt;/script&gt;
</code></pre><p>Then, we can import OrbitControls by adding the following to our main script:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword module keyword-import">import</span> <span class="token imports"><span class="token punctuation">{</span><span class="token maybe-class-name">OrbitControls</span><span class="token punctuation">}</span></span> <span class="token keyword module keyword-from">from</span> <span class="token string">&apos;./js/OrbitControls.js&apos;</span><span class="token punctuation">;</span>
</pre><p>Then, in the global scope, we can create a new instance of OrbitControls, after the camera and render have been created:</p>
<pre data-role="codeBlock" data-info="diff" class="language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   import * as THREE from &apos;./js/three.module.js&apos;;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   import {OrbitControls} from &apos;./js/ OrbitControls.js&apos;;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   const scene = new THREE.Scene();
</span><span class="token prefix unchanged"> </span><span class="token line">   const camera = new THREE.PerspectiveCamera(    75, window.innerWidth / window.innerHeight,   0. 1, 1000 ); 
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   const renderer = new THREE.WebGLRenderer();
</span><span class="token prefix unchanged"> </span><span class="token line">   renderer.setSize( window.innerWidth, window.   innerHeight );
</span><span class="token prefix unchanged"> </span><span class="token line">   document.body.appendChild( renderer.   domElement ); 
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const controls = new THREE.OrbitControls( camera, renderer.domElement );
</span></span></pre><p>Then, in the animation loop, we can call the <code>update()</code> method on the controls object:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">controls<span class="token punctuation">.</span><span class="token method function property-access">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>With everything in place, we should be able to rotate the camera around the scene by clicking and dragging the mouse. Dragging the mouse in combination with the shift or control key will allow us to pan the camera, and the scroll wheel will allow us to zoom in and out.</p>
<p>Using OrbitControls should look a bit like this:<br>
<img src="screenshots\step-12.gif" alt="Step-12"></p>
<h2 class="mume-header" id="-step-13-add-the-molecule-to-a-group-rather-than-the-scene-">Step 13: Add the molecule to a group, rather than the scene:</h2>

<p>Since we will be adding multiple molecules to the scene, we can add each molecule to a group, and then add the group to the scene. This will allow us to manipulate the group as a whole, rather than each individual molecule.</p>
<p>Begin by creating a new group in the global scope:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-let">let</span> moleculeGroup <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-function">function</span> <span class="token function">drawMolecule</span><span class="token punctuation">(</span><span class="token parameter">molFile</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token spread operator">...</span>
<span class="token punctuation">}</span>
</pre><p>Then, instead of adding the sphere to the scene, we can add it to the group, and then add the group to the scene:</p>
<pre data-role="codeBlock" data-info="diff" class="language-diff">let moleculeGroup = new THREE.Group();

function drawMolecule(molFile){
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   for(let item of molObject.atoms){
</span><span class="token prefix unchanged"> </span><span class="token line">       const sphere = new THREE.Mesh( moleculeGeometries[item.type], moleculeMaterials[item.type] );
</span><span class="token prefix unchanged"> </span><span class="token line">       
</span><span class="token prefix unchanged"> </span><span class="token line">       sphere.position.x = item.position.x - moleculeCenter.x;
</span><span class="token prefix unchanged"> </span><span class="token line">       sphere.position.y = item.position.y - moleculeCenter.y;
</span><span class="token prefix unchanged"> </span><span class="token line">       sphere.position.z = item.position.z - moleculeCenter.z;
</span><span class="token prefix unchanged"> </span><span class="token line">       
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">       scene.add( sphere );
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       moleculeGroup.add( sphere );
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   scene.add( moleculeGroup );
</span></span>}
</pre><p>This will allow us to manipulate the group as a whole, rather than each individual molecule. This will be useful in the next step, when we add the ability to manipulate the molecule.</p>
<h2 class="mume-header" id="-step-14-adding-datgui-and-manipulating-the-molecule-group-">Step 14: Adding datgui and manipulating the molecule group:</h2>

<p>We can use datgui to add a user interface to our application. This will allow us to manipulate the molecule group, and see the changes in real time.</p>
<p>To use datgui, download or install it using npm. To use it with the project, we can add the following to the head of the HTML file:</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    ...
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>js/datgui/dat.gui.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
</pre><p>We can then add a new GUI in the init function:</p>
<pre data-role="codeBlock" data-info="diff" class="language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const gui = new dat.GUI();
</span></span></pre><p>Then, we can add a folder to the GUI, and add a slider to the folder:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> moleculePosition <span class="token operator">=</span> gui<span class="token punctuation">.</span><span class="token method function property-access">addFolder</span><span class="token punctuation">(</span><span class="token string">&apos;Position&apos;</span><span class="token punctuation">)</span>
moleculePosition<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>moleculeGroup<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">,</span> <span class="token string">&apos;x&apos;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
moleculePosition<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>moleculeGroup<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">,</span> <span class="token string">&apos;y&apos;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
moleculePosition<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>moleculeGroup<span class="token punctuation">.</span><span class="token property-access">position</span><span class="token punctuation">,</span> <span class="token string">&apos;z&apos;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>

<span class="token keyword keyword-const">const</span> moleculeRotation <span class="token operator">=</span> gui<span class="token punctuation">.</span><span class="token method function property-access">addFolder</span><span class="token punctuation">(</span><span class="token string">&apos;Rotation&apos;</span><span class="token punctuation">)</span>
moleculeRotation<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>moleculeGroup<span class="token punctuation">.</span><span class="token property-access">rotation</span><span class="token punctuation">,</span> <span class="token string">&apos;x&apos;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span>
moleculeRotation<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>moleculeGroup<span class="token punctuation">.</span><span class="token property-access">rotation</span><span class="token punctuation">,</span> <span class="token string">&apos;y&apos;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span>
moleculeRotation<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>moleculeGroup<span class="token punctuation">.</span><span class="token property-access">rotation</span><span class="token punctuation">,</span> <span class="token string">&apos;z&apos;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span>

<span class="token keyword keyword-const">const</span> moleculeScale <span class="token operator">=</span> gui<span class="token punctuation">.</span><span class="token method function property-access">addFolder</span><span class="token punctuation">(</span><span class="token string">&apos;Scale&apos;</span><span class="token punctuation">)</span>
<span class="token keyword keyword-const">const</span> scaleX <span class="token operator">=</span> moleculeScale<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>moleculeGroup<span class="token punctuation">.</span><span class="token property-access">scale</span><span class="token punctuation">,</span> <span class="token string">&apos;x&apos;</span><span class="token punctuation">,</span> <span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">name</span><span class="token punctuation">(</span><span class="token string">&quot;Scaling Factor&quot;</span><span class="token punctuation">)</span>
scaleX<span class="token punctuation">.</span><span class="token method function property-access">onChange</span><span class="token punctuation">(</span><span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
moleculeGroup<span class="token punctuation">.</span><span class="token property-access">scale</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
moleculeGroup<span class="token punctuation">.</span><span class="token property-access">scale</span><span class="token punctuation">.</span><span class="token property-access">z</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre><p>This will give you a set of controls that will allow you to manipulate the molecule group. The controls should look something like this:<br>
<img src="screenshots\step-14.png" alt="Step-14"></p>
<h2 class="mume-header" id="-step-15-adding-auto-rotation-">Step 15: Adding auto-rotation:</h2>

<p>We can add auto-rotation to the molecule group by adding a few things, firstly, a variable to keep track of whether or not auto-rotation is enabled:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-let">let</span> autoRotate <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow keyword-switch">switch</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</pre><p>Then, within the <code>init()</code> function, we can add a checkbox to the GUI, and add an event listener to the checkbox:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">gui<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>autoRotate<span class="token punctuation">,</span> <span class="token string">&quot;switch&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">name</span><span class="token punctuation">(</span><span class="token string">&quot;Auto Rotate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Finally, we can add a check to the animation loop, to see if auto-rotation is enabled, and if so, rotate the molecule group:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword control-flow keyword-if">if</span><span class="token punctuation">(</span>autoRotate<span class="token punctuation">.</span><span class="token keyword control-flow keyword-switch">switch</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    moleculeGroup<span class="token punctuation">.</span><span class="token property-access">rotation</span><span class="token punctuation">.</span><span class="token property-access">x</span><span class="token operator">-=</span><span class="token number">.5</span><span class="token operator">*</span>deltaTime<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>Then, we&apos;ll be able to toggle auto-rotation on and off, and see the molecule rotate in real time, like so:</p>
<p><img src="screenshots\step-15.gif" alt="Step-15"></p>
<h2 class="mume-header" id="-step-16-adding-buttons-to-toggle-the-molecule-type-in-the-menu-">Step 16: Adding buttons to toggle the molecule type in the menu:</h2>

<p>We can add buttons to the menu, to toggle between the different molecule types. To do this, we can add a new function to the GUI object, that will be called when the button is clicked:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-var">var</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">showCaffeine</span> <span class="token operator">:</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">CSID</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token function">getMolecule</span><span class="token punctuation">(</span><span class="token number">2424</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">showEthanol</span> <span class="token operator">:</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">CSID</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token function">getMolecule</span><span class="token punctuation">(</span><span class="token number">682</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">showCatnip</span> <span class="token operator">:</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">CSID</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token function">getMolecule</span><span class="token punctuation">(</span><span class="token number">141747</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">showCinnamon</span> <span class="token operator">:</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">CSID</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token function">getMolecule</span><span class="token punctuation">(</span><span class="token number">553117</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Then, we can add the buttons to the menu:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword keyword-const">const</span> moleculeType <span class="token operator">=</span> gui<span class="token punctuation">.</span><span class="token method function property-access">addFolder</span><span class="token punctuation">(</span><span class="token string">&apos;Example Molecules   &apos;</span><span class="token punctuation">)</span>
moleculeType<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token string">&apos;showCaffeine&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">name</span><span class="token punctuation">(</span><span class="token string">&apos;Caffeine (Coffee, Chocolate, Tea)&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
moleculeType<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token string">&apos;showEthanol&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">name</span><span class="token punctuation">(</span><span class="token string">&apos;Ethanol (Alcohol)&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
moleculeType<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token string">&apos;showCatnip&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">name</span><span class="token punctuation">(</span><span class="token string">&apos;Nepetalactone (Catnip)&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
moleculeType<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token string">&apos;showCinnamon&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">name</span><span class="token punctuation">(</span><span class="token string">&apos;Cinnamaldehyde (Cinnamon Smell)&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>